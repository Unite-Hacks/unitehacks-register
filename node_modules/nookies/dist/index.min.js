"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var o,s=1,r=arguments.length;s<r;s++)for(var i in o=arguments[s])Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);return e}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.destroyCookie=exports.setCookie=exports.parseCookies=void 0;var cookie=require("cookie"),setCookieParser=require("set-cookie-parser"),utils_1=require("./utils");function parseCookies(e,o){var s,r;return(null===(r=null===(s=null==e?void 0:e.req)||void 0===s?void 0:s.headers)||void 0===r?void 0:r.cookie)?cookie.parse(e.req.headers.cookie,o):utils_1.isBrowser()?cookie.parse(document.cookie,o):{}}function setCookie(e,o,s,r){var i,t;if(void 0===r&&(r={}),(null===(i=null==e?void 0:e.res)||void 0===i?void 0:i.getHeader)&&e.res.setHeader){if(null===(t=null==e?void 0:e.res)||void 0===t?void 0:t.finished)return console.warn('Not setting "'+o+'" cookie. Response has finished.'),console.warn("You should set cookie before res.send()"),{};var n=e.res.getHeader("Set-Cookie")||[];"string"==typeof n&&(n=[n]),"number"==typeof n&&(n=[]);var a=setCookieParser.parse(n,{decodeValues:!1}),u=utils_1.createCookie(o,s,r),l=[];a.forEach((function(e){if(!utils_1.areCookiesEqual(e,u)){var o=cookie.serialize(e.name,e.value,__assign({encode:function(e){return e}},e));l.push(o)}})),l.push(cookie.serialize(o,s,r)),e.res.setHeader("Set-Cookie",l)}if(utils_1.isBrowser()){if(r&&r.httpOnly)throw new Error("Can not set a httpOnly cookie in the browser.");document.cookie=cookie.serialize(o,s,r)}return{}}function destroyCookie(e,o,s){return setCookie(e,o,"",__assign(__assign({},s||{}),{maxAge:-1}))}exports.parseCookies=parseCookies,exports.setCookie=setCookie,exports.destroyCookie=destroyCookie,exports.default={set:setCookie,get:parseCookies,destroy:destroyCookie};
//# sourceMappingURL=index.min.js.map